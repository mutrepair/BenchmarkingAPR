                if (k == ~d || k != d && vDown[i-1] < vDown[i+1]) {

